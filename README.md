### JPA 사용이유

- 생산성 : CURL SQL직접 작성하지 않아도됨. 테이블 생성 SQL문 작성 안해도 됨.데이터베이스 중심 설계에서 객체 중심 설계로
- 유지보수 : DB에 컬럼이 추가될 때마다 테이블 수정, SQL수정 하는 과정이 없다. JPA가 대신 처리해주니까!
- 패러다임의 불일치 해결 : 상속,연관관계, 객체 그래프 탐색, 비교하기와 같은 패러다임의 불일치 문제를 해결해 준다고 한다. (이 글을 작성하는 시점에서는 이해하지 못했다.)
- 성능 : JPA를 사용하면, 같은 트랜잭션안에서 select SQL이 여러번 호출된다면, 한번만 데이터베이스와 통신하고, 두번째부터는 조회한 객체를 재사용 함.
- 데이터 접근 추상화 / 벤더 독립성 JPA를 사용하면 JPA에게 다른 데이터베이스를 사용한다고 알려주기만 하면된다. 따라서 로컬에선 H2, 실제 DB는 오라클/Mysql을 사용하는 것이 아주 쉽다.

Restful APIs를 만드는 이유

Restful APIs를 만드는 가장 큰 이유는 Client Side를 정형화된 플랫폼이 아닌 모바일, PC, 어플리케이션 등 플렛폼에 제약을 두지 않는 것을 목표로 했기 때문이다.

jwt 토큰 쿠키저장 문제점 : 토큰을 쿠키에 저장하기에 토큰 탈취시 악의적인 목적으로 사용이 가능하게 된다.

JWT를 이용하면서 생길 수 있는 가장 큰 문제다.

https 연결을 이용하고 XSS같은 것도 다 막았지만 컴퓨터 해킹 등의 이유로 토큰이 탈취당했다고 생각해보자. 탈취한 토큰을 이용해 서버로 요청을 전송하는 경우 서버는 토큰을 무효화할 방법이 없다.

가장 간단하게는 토큰 발급 시 접속 IP를 같이 기록한 후 API 호출 시 요청 IP와 토큰에 기록된 IP를 비교하는 방법이 있는 것 같다. 토큰에 필드를 하나 추가하고 검사할 때 IP를 검사하는 로직만 추가하면 된다. 다만 완벽한 해결책은 아니다. 또한 모바일에서 LTE, 3G, 와이파이 전환이 자주 일어나며 IP가 자주 변경되는 경우 사용자가 자꾸 다시 로그인 해야 하는 불편함을 경험할 수 있다.

또는 만료시간이 긴 토큰 하나, 실제로 서버에 무언가 요청할 때 보내기 위해 쓰는 토큰을 나누어서 관리하는 방법이 있는 것 같다. 실제 요청 때 쓰는 토큰은 만료시간을 짧게 주고, 토큰이 만료되면 만료시간이 긴 토큰으로 서버에 요청하는 식으로 관리하는 것 같다. 이런 경우 토큰이 탈취된 상황에서도 다른 경우에 비해 상대적으로 짧은 시간 내에 토큰이 자동으로 무효화된다. 그리고 만료시간이 긴 토큰에 대해서만 잘 관리하면 성능과 보안 사이에서 균형있는 서비스가 가능할 것 같다.