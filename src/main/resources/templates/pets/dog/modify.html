<!DOCTYPE html>
<html 	xmlns:th="http://www.thymeleaf.org"
         xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
         layout:decorator="layout/default">

<div layout:fragment="content">

    <section id="portfolio" class="portfolio">
        <div class="container" style="margin-top: 30px;">
            <form>
                <small>제목</small>
                <input class="form-control" type="text" id="id" name="id" th:value="${post.id}" readonly/>
                <input class="form-control" type="text" id="title" name="title" th:value="${post.title}"/>
                <small>내용</small>
                <textarea class="form-control" id="content" name="content" th:text="${post.content}"></textarea>
                <small>작성자</small>
                <input class="form-control" type="text" id="writer" name="writer" th:value="${post.writer}" readonly/>
            </form>
            <button class="btn btn-primary" type="button" id="btn-modify">수정</button>
            <a href="/" role="button" class="btn btn-secondary">취소</a>
        </div>
    </section>

    <div class="d-lg-none scroll-to-top position-fixed rounded"><a
            class="d-block js-scroll-trigger text-center text-white rounded" href="#page-top"><i
            class="fa fa-chevron-up"></i></a></div>

</div>

<th:block layout:fragment="script">
    <script th:inline="javascript">
        $('#content').summernote({
            //height: 500,                 // 에디터 높이
            minHeight: 500,             // 최소 높이
            maxHeight: null,             // 최대 높이
            focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
            lang: "ko-KR",              // 한글 설정
            spellCheck: false,
            placeholder: '최대 2048자까지 쓸 수 있습니다',	//placeholder 설정
            callbacks: {	//여기 부분이 이미지를 첨부하는 부분
                onImageUpload : function(files) {
                    uploadSummernoteImageFile(files[0],this);
                }
            }
        });

        $("div.note-editable").on('drop',function(e){
            for(i=0; i< e.originalEvent.dataTransfer.files.length; i++){
                uploadSummernoteImageFile(e.originalEvent.dataTransfer.files[i],$("#summernote")[0]);
            }
            e.preventDefault();
        })
        /**
         * 이미지 파일 업로드
         */
        function uploadSummernoteImageFile(file, editor) {
            data = new FormData();
            data.append("file", file);
            $.ajax({
                data : data,
                type : "POST",
                url : "/uploadSummernoteImageFile",
                contentType : false,
                processData : false,
                success : function(data) {
                    //항상 업로드된 파일의 url이 있어야 한다.
                    $(editor).summernote('insertImage', data.url);
                }
            });
        }
    </script>
</th:block>

</html>